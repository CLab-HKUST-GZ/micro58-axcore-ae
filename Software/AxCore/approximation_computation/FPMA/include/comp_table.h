#ifndef COMP_TABLE_H
#define COMP_TABLE_H

#include <stdint.h>
#include <cuda.h>
#include <cuda_runtime.h>

#define COMP_TABLE_SIZE 8
// #define COMP_TABLE_SIZE 16

// __constant__ uint16_t comp_table[COMP_TABLE_SIZE][COMP_TABLE_SIZE];
__constant__ uint16_t comp_table_const_bf16_8x8[COMP_TABLE_SIZE][COMP_TABLE_SIZE] = {
    {0,  1,  2,  3,  4,  5,  6, 3},
    {1,  4,  7, 10, 13, 14, 10, 3},
    {2,  7, 12, 17, 19, 14,  8, 3},
    {3, 10, 17, 20, 16, 11,  7, 2},
    {4, 13, 19, 16, 12,  9,  5, 2},
    {5, 14, 14, 11,  9,  6,  4, 1},
    {6, 10,  8,  7,  5,  4,  2, 1},
    {3,  3,  3,  2,  2,  1,  1, 0},
};

__constant__ uint16_t comp_table_const_fp16_8x8[COMP_TABLE_SIZE][COMP_TABLE_SIZE] = {
    { 4,  12,  20,  28,  36,  44, 48, 24},
    {12,  36,  60,  84, 108, 115, 78, 26},
    {20,  60, 100, 139, 148, 110, 66, 22},
    {28,  84, 139, 158, 126,  90, 54, 18},
    {36, 108, 148, 126,  98,  70, 42, 14},
    {44, 115, 110,  90,  70,  50, 30, 10},
    {48,  78,  66,  54,  42,  30, 18,  6},
    {24,  26,  22,  18,  14,  10,  6,  2},
};

// __constant__ uint16_t comp_table_const[COMP_TABLE_SIZE][COMP_TABLE_SIZE] = {
//     {0,  0,  1,  1,  1,  1,  1,  2,  2,  2,  2,  2,  3,  3,  3,  1},
//     {0,  1,  2,  2,  3,  4,  5,  5,  6,  7,  7,  8,  9,  8,  6,  2},
//     {1,  2,  3,  4,  5,  7,  8,  9, 10, 12, 13, 14, 12,  9,  5,  2},
//     {1,  2,  4,  6,  8,  9, 11, 13, 14, 16, 17, 14, 11,  8,  5,  2},
//     {1,  3,  5,  8, 10, 12, 14, 16, 19, 19, 16, 13, 10,  7,  5,  2},
//     {1,  4,  7,  9, 12, 15, 17, 20, 20, 17, 15, 12,  9,  7,  4,  2},
//     {1,  5,  8, 11, 14, 17, 20, 20, 18, 16, 13, 11,  9,  6,  4,  1},
//     {2,  5,  9, 13, 16, 20, 20, 18, 16, 14, 12, 10,  8,  5,  3,  1},
//     {2,  6, 10, 14, 19, 20, 18, 16, 14, 12, 11,  9,  7,  5,  3,  1},
//     {2,  7, 12, 16, 19, 17, 16, 14, 12, 11,  9,  8,  6,  4,  3,  1},
//     {2,  7, 13, 17, 16, 15, 13, 12, 11,  9,  8,  6,  5,  4,  2,  1},
//     {2,  8, 14, 14, 13, 12, 11, 10,  9,  8,  6,  5,  4,  3,  2,  1},
//     {3,  9, 12, 11, 10,  9,  9,  8,  7,  6,  5,  4,  3,  2,  1,  0},
//     {3,  8,  9,  8,  7,  7,  6,  5,  5,  4,  4,  3,  2,  2,  1,  0},
//     {3,  6,  5,  5,  5,  4,  4,  3,  3,  3,  2,  2,  1,  1,  1,  0},
//     {1,  2,  2,  2,  2,  2,  1,  1,  1,  1,  1,  1,  0,  0,  0,  0},
// };

#endif // COMP_TABLE_H
